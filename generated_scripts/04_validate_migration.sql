-- =====================================================\n-- SCRIPT DE VALIDAÇÃO PÓS-MIGRAÇÃO\n-- Gerado em: 2025-10-06 14:21:54\n-- Gerador: SQLScriptGenerator v4.0.0\n-- =====================================================\n\n-- Verificar usuários criados\nSELECT 'USUÁRIOS CRIADOS' AS categoria, count(*) AS total\nFROM pg_roles\nWHERE rolname NOT LIKE 'pg_%' AND rolname != 'postgres';\n\n-- Verificar bases criadas\nSELECT 'BASES CRIADAS' AS categoria, count(*) AS total\nFROM pg_database\nWHERE datname NOT IN ('postgres', 'template0', 'template1');\n\n-- Verificar grants aplicados\nSELECT 'GRANTS APLICADOS' AS categoria, count(*) AS total\nFROM (\n    SELECT DISTINCT d.datname, grantee::regrole::text\n    FROM pg_database d,\n         aclexplode(COALESCE(d.datacl, acldefault('d', d.datdba)))\n    WHERE d.datname NOT IN ('postgres', 'template0', 'template1')\n) AS grants;\n\n-- Verificações específicas de grants:\n\nSELECT 'app_workforce' AS database,\n       grantee::regrole::text AS user,\n       privilege_type AS privilege\nFROM pg_database d,\n     aclexplode(COALESCE(d.datacl, acldefault('d', d.datdba)))\nWHERE d.datname = 'app_workforce'\nORDER BY grantee, privilege_type;\n\nSELECT 'botpress_db' AS database,\n       grantee::regrole::text AS user,\n       privilege_type AS privilege\nFROM pg_database d,\n     aclexplode(COALESCE(d.datacl, acldefault('d', d.datdba)))\nWHERE d.datname = 'botpress_db'\nORDER BY grantee, privilege_type;\n\nSELECT 'n8n_db' AS database,\n       grantee::regrole::text AS user,\n       privilege_type AS privilege\nFROM pg_database d,\n     aclexplode(COALESCE(d.datacl, acldefault('d', d.datdba)))\nWHERE d.datname = 'n8n_db'\nORDER BY grantee, privilege_type;